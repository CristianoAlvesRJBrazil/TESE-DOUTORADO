# Explorar a estrutura real dos dados
print("=== EXPLORANDO ESTRUTURA DOS DADOS ===")

import os
import glob
import nibabel as nib
import numpy as np
import matplotlib.pyplot as plt

def explorar_estrutura():
    base_dir = '/content/brats2020'
    
    if not os.path.exists(base_dir):
        print("âŒ DiretÃ³rio brats2020 nÃ£o encontrado!")
        return None
    
    print("ğŸ“‚ Estrutura encontrada:")
    print("=" * 50)
    
    for item in os.listdir(base_dir):
        item_path = os.path.join(base_dir, item)
        if os.path.isdir(item_path):
            print(f"ğŸ“ {item}/")
            # Mostrar primeiros 3 itens dentro de cada diretÃ³rio
            for subitem in os.listdir(item_path)[:3]:
                subitem_path = os.path.join(item_path, subitem)
                if os.path.isdir(subitem_path):
                    print(f"   â””â”€â”€ ğŸ“ {subitem}/")
                    # Mostrar arquivos dentro do caso
                    files = os.listdir(subitem_path)
                    for file in files[:2]:
                        print(f"        â””â”€â”€ ğŸ“„ {file}")
                else:
                    print(f"   â””â”€â”€ ğŸ“„ {subitem}")
        else:
            print(f"ğŸ“„ {item}")
    
    return base_dir

base_dir = explorar_estrutura()

# MÃ©todo 2: Busca automÃ¡tica por qualquer arquivo .nii.gz
print("\n=== MÃ‰TODO 2: BUSCA AUTOMÃTICA ===")

def busca_automatica():
    # Buscar todos os arquivos .nii.gz
    arquivos_nii = glob.glob('/content/brats2020/**/*.nii.gz', recursive=True)
    arquivos_nii += glob.glob('/content/brats2020/**/*.nii', recursive=True)
    
    print(f"ğŸ“Š Total de arquivos .nii encontrados: {len(arquivos_nii)}")
    
    if not arquivos_nii:
        print("âŒ Nenhum arquivo .nii encontrado!")
        return None
    
    # Mostrar primeiros 10 arquivos
    print("\nğŸ“‹ Primeiros 10 arquivos encontrados:")
    for i, arquivo in enumerate(arquivos_nii[:10]):
        print(f"  {i+1}. {os.path.basename(arquivo)}")
        print(f"     ğŸ“ {os.path.dirname(arquivo)}")
    
    # Pegar o primeiro arquivo FLAIR encontrado
    arquivo_flair = None
    for arquivo in arquivos_nii:
        if 'flair' in arquivo.lower():
            arquivo_flair = arquivo
            break
    
    if arquivo_flair:
        print(f"\nğŸ¯ Usando arquivo FLAIR: {os.path.basename(arquivo_flair)}")
        
        # Carregar e mostrar
        img = nib.load(arquivo_flair)
        data = img.get_fdata()
        
        print(f"ğŸ“ DimensÃµes: {data.shape}")
        print(f"ğŸ“Š EstatÃ­sticas: min={data.min():.1f}, max={data.max():.1f}, mean={data.mean():.1f}")
        
        # VisualizaÃ§Ã£o rÃ¡pida
        plt.figure(figsize=(10, 5))
        plt.imshow(data[:, :, data.shape[2]//2], cmap='gray')
        plt.title(f"FLAIR - {os.path.basename(arquivo_flair)}\nShape: {data.shape}")
        plt.axis('off')
        plt.colorbar()
        plt.show()
        
        return data
    else:
        print("âŒ Nenhum arquivo FLAIR encontrado!")
        return None

# Executar mÃ©todo 2
imagem_exemplo = busca_automatica()

